{"version":3,"file":"RefreshOnFocus.js","sources":["../../src/client-components/live/RefreshOnFocus.tsx"],"sourcesContent":["import {useRouter} from 'next/navigation.js'\nimport {useEffect} from 'react'\n\nconst focusThrottleInterval = 5_000\n\nexport default function RefreshOnFocus(): null {\n  const router = useRouter()\n\n  useEffect(() => {\n    const controller = new AbortController()\n    let nextFocusRevalidatedAt = 0\n    const callback = () => {\n      const now = Date.now()\n      if (now > nextFocusRevalidatedAt && document.visibilityState !== 'hidden') {\n        router.refresh()\n        nextFocusRevalidatedAt = now + focusThrottleInterval\n      }\n    }\n    const {signal} = controller\n    document.addEventListener('visibilitychange', callback, {passive: true, signal})\n    window.addEventListener('focus', callback, {passive: true, signal})\n    return () => controller.abort()\n  }, [router])\n\n  return null\n}\nRefreshOnFocus.displayName = 'RefreshOnFocus'\n"],"names":[],"mappings":";;AAGA,MAAM,wBAAwB;AAE9B,SAAwB,iBAAuB;AAC7C,QAAM,SAAS,UAAA;AAEf,SAAA,UAAU,MAAM;AACd,UAAM,aAAa,IAAI,gBAAA;AACvB,QAAI,yBAAyB;AAC7B,UAAM,WAAW,MAAM;AACrB,YAAM,MAAM,KAAK,IAAA;AACb,YAAM,0BAA0B,SAAS,oBAAoB,aAC/D,OAAO,WACP,yBAAyB,MAAM;AAAA,IAEnC,GACM,EAAC,OAAA,IAAU;AACjB,WAAA,SAAS,iBAAiB,oBAAoB,UAAU,EAAC,SAAS,IAAM,OAAA,CAAO,GAC/E,OAAO,iBAAiB,SAAS,UAAU,EAAC,SAAS,IAAM,QAAO,GAC3D,MAAM,WAAW,MAAA;AAAA,EAC1B,GAAG,CAAC,MAAM,CAAC,GAEJ;AACT;AACA,eAAe,cAAc;"}